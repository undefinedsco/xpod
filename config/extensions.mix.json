{
  "@context": [
    "https://linkedsoftwaredependencies.org/bundles/npm/@solid/community-server/^7.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/@undefineds/xpod/^0.0.0/components/context.jsonld",
    {
      "UsageTrackingStore": "urn:undefineds:xpod:UsageTrackingStore#",
      "PerAccountQuotaStrategy": "urn:undefineds:xpod:PerAccountQuotaStrategy#",
      "DrizzleQuotaService": "urn:undefineds:xpod:DrizzleQuotaService#",
      "DefaultQuotaService": "urn:undefineds:xpod:DefaultQuotaService#",
      "NoopQuotaService": "urn:undefineds:xpod:NoopQuotaService#"
    }
  ],
  "import": [
    "./xpod.json",
    "./xpod.cluster.json"
  ],
  "@graph": [
    {
      "comment": "Default quota limits (in-memory overrides)",
      "@id": "urn:undefineds:xpod:QuotaService",
      "@type": "DefaultQuotaService",
      "DefaultQuotaService:_options_defaultAccountQuotaBytes": { "@type": "Literal", "value": 10737418240 }
    },
    {
      "comment": "Controls whether edge-specific features follow cluster or local defaults.",
      "@id": "urn:solid-server:default:variable:xpodEdition",
      "@type": "Variable"
    },
    {
      "comment": "Signaling service endpoint for edge nodes.",
      "@id": "urn:solid-server:default:variable:xpodSignalEndpoint",
      "@type": "Variable"
    },
    {
      "comment": "Whether edge node registry is enabled.",
      "@id": "urn:solid-server:default:variable:xpodEdgeNodesEnabled",
      "@type": "Variable"
    },
    {
      "comment": "Connection string for identity metadata (accounts, pods, quota).",
      "@id": "urn:solid-server:default:variable:identityDbUrl",
      "@type": "Variable"
    },
    {
      "@id": "urn:undefineds:xpod:MixDataAccessor",
      "@type": "MixDataAccessor",
      "endpoint": "sqlite:./.data/quadstore.sqlite",
      "identifierStrategy": { "@id": "urn:solid-server:default:IdentifierStrategy" },
      "unstructuredDataAccessor": { "@id": "urn:undefineds:xpod:RemoteDataAccessor" }
    },
    {
      "@id": "urn:undefineds:xpod:RemoteDataAccessor",
      "@type": "MinioDataAccessor",
      "resourceMapper": { "@id": "urn:solid-server:default:FileIdentifierMapper" },
      "accessKey": "iknkxtc8",
      "secretKey": "wrx4rt7wg2xzvb7s",
      "endpoint": "objectstorageapi.gzg.sealos.run",
      "bucketName": "iknkxtc8-solid"
    },
    {
      "@type": "Ignore",
      "overrideInstance": {
        "@id": "urn:solid-server:default:FileResourceStore"
      },
      "overrideParameters": {
        "@type": "DataAccessorBasedStore",
        "accessor": { "@id": "urn:undefineds:xpod:RemoteDataAccessor" }
      }
    },
    {
      "@type": "Override",
      "overrideInstance": {
        "@id": "urn:solid-server:default:SparqlResourceStore"
      },
      "overrideParameters": {
        "@type": "RepresentationPartialConvertingStore",
        "metadataStrategy": { "@id": "urn:solid-server:default:AuxiliaryStrategy" },
        "options_inConverter": { "@id": "urn:solid-server:default:RepresentationConverter" },
        "options_inPreferences_type": {
          "RepresentationPartialConvertingStore:_options_inPreferences_type_key": "internal/quads",
          "RepresentationPartialConvertingStore:_options_inPreferences_type_value": 1
        },
        "RepresentationPartialConvertingStore:_source": {
          "@type": "npmd:@undefineds/xpod/^0.0.0/dist/storage/quota/UsageTrackingStore.jsonld#UsageTrackingStore",
          "UsageTrackingStore:source": {
            "@type": "DataAccessorBasedStore",
            "identifierStrategy": { "@id": "urn:solid-server:default:IdentifierStrategy" },
            "auxiliaryStrategy": { "@id": "urn:solid-server:default:AuxiliaryStrategy" },
            "metadataStrategy": { "@id": "urn:solid-server:default:MetadataStrategy" },
            "accessor": { "@id": "urn:undefineds:xpod:MixDataAccessor" }
          },
          "UsageTrackingStore:options_identityDbUrl": { "@id": "urn:solid-server:default:variable:identityDbUrl", "@type": "Variable" },
          "UsageTrackingStore:options_defaultAccountBandwidthLimitBps": { "@type": "Literal", "value": 10485760 }
        }
      }
    },
    {
      "comment": "Apply bandwidth limits to SPARQL responses",
      "@type": "Override",
      "overrideInstance": { "@id": "urn:undefineds:xpod:SubgraphSparqlHttpHandler" },
      "overrideParameters": {
        "@type": "SubgraphSparqlHttpHandler",
        "options_defaultAccountBandwidthLimitBps": { "@type": "Literal", "value": 10485760 }
      }
    },
    {
      "@id": "urn:solid-server:default:variable:showStackTrace",
      "@type": "variable",
      "value": true
    },
    {
      "@id": "urn:solid-server:default:variable:baseUrl",
      "@value": "http://localhost:3000/"
    },
    {
      "comment": "Drizzle-backed account storage",
      "@type": "Override",
      "overrideInstance": {
        "@id": "urn:solid-server:default:AccountStorage"
      },
      "overrideParameters": {
        "@id": "urn:undefineds:xpod:DrizzleAccountStorage"
      }
    },
    {
      "@type": "Override",
      "overrideInstance": {
        "@id": "urn:solid-server:default:AccountStore"
      },
      "overrideParameters": {
        "@type": "BaseAccountStore",
        "storage": { "@id": "urn:undefineds:xpod:DrizzleAccountStorage" }
      }
    },
    {
      "@type": "Override",
      "overrideInstance": {
        "@id": "urn:solid-server:default:PodStore"
      },
      "overrideParameters": {
        "@type": "BasePodStore",
        "storage": { "@id": "urn:undefineds:xpod:DrizzleAccountStorage" },
        "manager": { "@id": "urn:solid-server:default:PodManager" }
      }
    },
    {
      "comment": "Quota strategy that enforces per-account limits",
      "@type": "Override",
      "overrideInstance": {
        "@id": "urn:solid-server:default:QuotaStrategy"
      },
      "overrideParameters": {
        "@type": "PerAccountQuotaStrategy",
        "PerAccountQuotaStrategy:_options_identityDbUrl": { "@id": "urn:solid-server:default:variable:identityDbUrl", "@type": "Variable" },
        "PerAccountQuotaStrategy:_options_defaultAccountQuotaBytes": { "@type": "Literal", "value": 10737418240 },
        "PerAccountQuotaStrategy:_options_quotaService": { "@id": "urn:undefineds:xpod:QuotaService" },
        "PerAccountQuotaStrategy:_reporter": { "@id": "urn:solid-server:default:SizeReporter" }
      }
    }
  ]
}
